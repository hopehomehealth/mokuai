<?php/** * ZZCMS 物流配送 */class express extends Lowxp{    function __construct(){        #按钮        $this->btnMenu = array(            0=>array('url'=>'#!express/index','name'=>'快递公司'),            1=>array('url'=>'#!express/edit?com=xshow|添加快递公司','name'=>'添加快递公司'),        );        parent::__construct();        $this->load->model('express');    }    function index($page=1){        #分页        $this->load->model('page');        $_GET['page'] = intval($page);        $this->page->set_vars(array('per'=>(int)$this->common['page_listrows']));        #数据集        $sql = "SELECT * FROM ###_express ORDER BY listorder,id";        $data['list'] = $this->page->hashQuery($sql)->result_array();        $this->smarty->assign('data',$data);        $this->smarty->display('manage/express/list.html');    }    //创建/更新    function edit(){        //提交        if(isset($_POST['Submit'])){            $res = $this->express->save();            if(isset($res['code']) && $res['code']==0){                $this->tip($res['message'],array('inIframe'=>true));                $this->exeJs("parent.com.xhide();parent.main.refresh()");            }else{                $this->tip($res['message'],array('inIframe'=>true,'type'=>1));            }            exit;        }        $id = (int) $_GET['id'];        $row = array();        //编辑        if($id){            $row = $this->db->get("SELECT * FROM ###_express WHERE id=".$id);            $this->smarty->assign('id',$id);        }        if(!$id) $this->smarty->assign('btnNo',1);        $this->smarty->assign('row',$row);        $this->smarty->display('manage/express/edit.html');    }    //删除    function del(){        $id = (int) $_POST['id'];        if(!$id) die;        admin_log('删除快递公司：'.$this->db->getstr("SELECT name FROM ###_express WHERE id=".$id));        $this->db->delete('###_express', array('id'=>$id));        $this->tip('删除成功',array('type'=>1));    }}